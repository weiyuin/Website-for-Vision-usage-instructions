<head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../css/main.css" /> 
           <script src="../../js/jquery.js"></script> 
           <script src="../../js/main.js"></script> 
           </head> 
           <head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../css/main.css" /> 
           <script src="../../../js/jquery.js"></script> 
           <script src="../../../js/main.js"></script> 
           </head>  
           <head>  
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../../css/main.css" /> 
           <script src="../../../../js/jquery.js"></script> 
           <script src="../../../../js/main.js"></script> 
           </head>
<h1>圆孔检测工具</h1>

<h2>功能</h2>

<p>在3D测量中，圆孔检测工具主要是检测深度数据图像中指定ROI区域内，是否存在满足半径约束和位置需求的圆孔，以协助进行测量或者定位。图1所示为一个满足半径约束的圆孔检测结果。</p>

<p><img src="media/wps98.jpg" alt="img" /></p>

<p><imgnote>图1 圆孔检测示意图</imgnote></p>

<h2>参数</h2>

<table>
<thead>
<tr>
<th>分类 </th>
<th> 参数名称          </th>
<th> 参数描述                                                                                               </th>
</tr>
</thead>
<tbody>
<tr>
<td> 属性窗口          </td>
<td> 标称半径                                                     </td>
<td> 圆孔的预期半径。                         </td>
</tr>
<tr>
<td></td>
<td> 半径偏差          </td>
<td> 相对于标称半径的最大偏差（偏差值为正数），可表示比标准圆半径偏小或偏大的圆。<img src="media/wps100.jpg" alt="img" />                                           </td>
</tr>
<tr>
<td></td>
<td> 启用矩形ROI       </td>
<td> 选择“是”，则使用矩形ROI检测区域，否则全图检测。                                                        </td>
</tr>
<tr>
<td></td>
<td> 平面度阈值        </td>
<td> 深度数据相对所在平面最大偏移与最小偏移的差值，平面度阈值将决定哪些边缘点同属一个平面上。该阈值为正数，且越小，参与计算的边缘点越少，默认值为0.08mm。<img src="media/wps101.jpg" alt="img" />                                           </td>
</tr>
<tr>
<td></td>
<td> 圆拟合RMS误差阈值 </td>
<td> 检测圆孔过程中对圆孔检测结果的约束条件，即将剔除RMS误差高于该阈值的检测结果，默认值为0.15。                                           </td>
</tr>
<tr>
<td></td>
<td> 启用深度限制      </td>
<td> 选择“是”，则显示深度阈值参数。                                                                         </td>
</tr>
<tr>
<td></td>
<td> 深度阈值          </td>
<td> 检测圆孔过程中对深度数据的深度约束条件，即将排除低于该深度阈值的深度数据。该约束为可选约束，仅在启用深度限制为是时有效。                                           </td>
</tr>
<tr>
<td></td>
<td> 启用参考平面区域  </td>
<td> 选择“是”，则参数链中显示参考平面参数。指定圆孔所在的平面，即检测的圆孔与参考平面在相同平面上。                                           </td>
</tr>
<tr>
<td></td>
<td> 检测结果分组号    </td>
<td> 检测结果会被分成不同组的同心圆。                                                                       </td>
</tr>
<tr>
<td></td>
<td> 检测结果类型      </td>
<td> 分为4种，最外侧圆、最内侧圆、最优圆、最标准圆。<img src="media/wps102.jpg" alt="img" />                                           </td>
</tr>
<tr>
<td> 图像窗口          </td>
<td> 深度图像                                                     </td>
<td> 显示待检测的深度图像，显示为伪彩色图像。 </td>
</tr>
<tr>
<td></td>
<td> 检测区域          </td>
<td> 属性窗口启用矩形ROI参数为是时，在图像上显示ROI区域。                                                   </td>
</tr>
<tr>
<td> 数据链            </td>
<td> 输入深度图像                                                 </td>
<td> 输入待检测的深度图像。                   </td>
</tr>
<tr>
<td></td>
<td> 二维线性变换      </td>
<td> 目标相对于模板的平移、旋转、缩放变换。                                                                 </td>
</tr>
<tr>
<td></td>
<td> 参考平面          </td>
<td> 属性窗口启用参考平面区域参数为是时，参数链显示参考平面参数，该参数来源是平面拟合工具。                                           </td>
</tr>
<tr>
<td>高级界面</td>
<td> 无                </td>
<td> 无                                                                                                     </td>
</tr>
</tbody>
</table>


<h2>输出</h2>

<table>
<thead>
<tr>
<th>分类 </th>
<th> 参数名称         </th>
<th> 参数描述                                                                       </th>
</tr>
</thead>
<tbody>
<tr>
<td> 监视窗口         </td>
<td> 输入深度图像                     </td>
<td> 输入图像的长宽和像素大小，以及深度数据参数。 </td>
</tr>
<tr>
<td></td>
<td> RMS误差          </td>
<td> 对应检测结果的RMS误差。                                                        </td>
</tr>
<tr>
<td></td>
<td> 圆孔半径         </td>
<td> 对应检测结果的半径。                                                           </td>
</tr>
<tr>
<td></td>
<td> 圆的完整度       </td>
<td> 对应检测结果的完整度。                                                         </td>
</tr>
<tr>
<td></td>
<td> 圆心坐标         </td>
<td> 对应检测结果圆心的三维坐标信息。                                               </td>
</tr>
<tr>
<td></td>
<td> 圆所在平面法向量 </td>
<td> 对应检测结果所在平面法向量。                                                   </td>
</tr>
<tr>
<td></td>
<td> 执行结果         </td>
<td> 工具执行结果。                                                                 </td>
</tr>
<tr>
<td></td>
<td> 执行时间         </td>
<td> 工具执行时间。                                                                 </td>
</tr>
<tr>
<td> 图像窗口         </td>
<td> 输入深度图像                     </td>
<td> 显示检测的深度图像，显示为伪彩色图像。       </td>
</tr>
<tr>
<td></td>
<td> 圆孔             </td>
<td> 显示检测结果圆孔及其中心。                                                     </td>
</tr>
<tr>
<td></td>
<td> 数据链           </td>
<td> 同监视窗口参数，供后续工具使用。                                               </td>
</tr>
</tbody>
</table>


<h2>详细说明</h2>

<h3>使用向导</h3>

<p><strong>Step 1 设置标称半径和半径偏差</strong></p>

<p>这里需要用户输入检测的圆孔半径和偏差，设置的越精确，检测结果越准确。圆孔的主要参数及其标称半径、半径偏差如图2所示。</p>

<p><img src="media/wps105.jpg" alt="img" />    <img src="media/wps106.jpg" alt="img" /></p>

<p><imgnote>(a) 圆孔参数</imgnote> <imgnote>(b) 半径约束</imgnote></p>

<p><imgnote>图2 圆孔参数、半径约束示意图</imgnote></p>

<p><strong>Step 2 设置检测区域</strong></p>

<p>默认情况下，圆孔检测执行的是全图检测，为了提高效率和精度，用户可以设置合适的矩形ROI区域。</p>

<p><strong>Step 3 设置高级参数</strong></p>

<p>高级参数主要包括：平面度阈值、圆拟合RMS误差阈值、深度限制阈值以及参考平面。在需要更高检测精度时，用户可根据需求对这些参数进行适当设置。</p>

<p><strong>Step 4 执行检测和输出结果</strong></p>

<p>在设置好参数后就可以执行圆孔检测，输出的结果包括：RMS误差、圆孔半径、圆心坐标，以及圆所在平面法向量。这里可以选择不同的“检测结果分组号”和“检测结果类型”来查看不同的检测结果。</p>

<p>检测结果类型包括以下4种：</p>

<ul>
<li><p><strong>最外侧圆：</strong>检测结果中，同组圆（忽略高度）中最外侧的圆，即同组圆中Z值最大的圆。</p></li>
<li><p><strong>最内侧圆：</strong>检测结果中，同组圆（忽略高度）中最内侧的圆，即同组圆中Z值最小的圆。</p></li>
<li><p><strong>最优圆： </strong>检测结果中，拟合RMS误差最小的圆。</p></li>
<li><p><strong>最标准圆：</strong>检测结果中，半径最接近标称半径的圆。</p></li>
</ul>


<h3>参数调整建议与说明</h3>

<table>
<thead>
<tr>
<th> 序号 </th>
<th> 参数    </th>
<th> 应用场景                   </th>
<th> 调整建议与说明                                     </th>
</tr>
</thead>
<tbody>
<tr>
<td> 1              </td>
<td> 平面度阈值        </td>
<td> 需提高检测结果精度                   </td>
<td> (1) 对于平行于XOY平面的待检测圆孔，点云数据质量较好的图像，适当降低平面度阈值可提高检测精度，以及拟合圆的边缘点在同一平面的可信度；<br />(2) 对于有一定倾斜的圆孔，可适当提高平面度阈值，以增加用于圆拟合的边缘点数目，提高检测倾斜圆孔结果的稳定性；<br />(3) 需注意平面度阈值不能过小，否则会导致圆孔不能通过有效性验证。 </td>
</tr>
<tr>
<td> 2              </td>
<td> 圆拟合RMS误差阈值 </td>
<td> 需提高检测结果精度                   </td>
<td> (1) 对于圆孔边缘较为平滑的图像，可适当降低阈值，以排除不理想的圆孔；<br />(2) 对于圆孔边缘不平滑、干扰点较多、突变较大的图像，即边缘不是理想圆的情况，可适当增大阈值，以提高检测非理想圆的稳定性；<br />(3) 需注意圆拟合RMS误差阈值不能过小，否则会减少圆孔检测结果； </td>
</tr>
<tr>
<td> 3              </td>
<td> 深度限制          </td>
<td> 复杂背景图像或需增强圆孔深度约束     </td>
<td> (1) 通过恰当的深度约束，可排除深度不符合需求的非圆孔边缘点，提高检测效率和准确性；<br />(2) 深度限制不宜过大，否则不能起到深度约束作用； </td>
</tr>
<tr>
<td> 4              </td>
<td> 参考平面          </td>
<td> 复杂背景图像或需增强圆孔所在平面约束 </td>
<td> (1) 通过约束圆孔所在平面，结合平面度，可排除不在平面上的非圆孔边缘点，提高检测效率和准确性；(2) 这里参考平面可通过平面拟合工具给出； </td>
</tr>
</tbody>
</table>


<h2>注意</h2>

<p>无</p>

<h2>示例工程</h2>

<p>参见“\Samples\3D\深度图\3D测量工具.gvp”。</p>
