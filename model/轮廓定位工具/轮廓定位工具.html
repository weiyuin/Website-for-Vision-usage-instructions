<head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../css/main.css" /> 
           <script src="../../js/jquery.js"></script> 
           <script src="../../js/main.js"></script> 
           </head> 
           <head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../css/main.css" /> 
           <script src="../../../js/jquery.js"></script> 
           <script src="../../../js/main.js"></script> 
           </head>  
           <head>  
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../../css/main.css" /> 
           <script src="../../../../js/jquery.js"></script> 
           <script src="../../../../js/main.js"></script> 
           </head>
<h1>轮廓定位工具</h1>

<h2>功能</h2>

<p>在3D定位中，轮廓定位工具主要通过固定ROI区域中训练轮廓的特征获取参考特征信息（参考特征点和角度信息），然后根据实时轮廓中相同ROI区域内的实时特征信息计算得到二维变换定位结果，以协助后续进行轮廓测量等操作。</p>

<h2>参数</h2>

<table>
<thead>
<tr>
<th>分类 </th>
<th> 参数名称     </th>
<th> 参数描述                                                                                                                   </th>
</tr>
</thead>
<tbody>
<tr>
<td> 属性窗口     </td>
<td> 定位模式                                                     </td>
<td> 分为3种：平移旋转、平移、旋转。其中，平移模式不考虑旋转、旋转模式不考虑平移 </td>
</tr>
<tr>
<td> 图像窗口     </td>
<td> 轮廓图像                                                     </td>
<td> 显示待检测的轮廓图像。                                       </td>
</tr>
<tr>
<td> 数据链       </td>
<td> 输入轮廓数据                                                 </td>
<td> 显示待检测的轮廓图像。                                       </td>
</tr>
<tr>
<td></td>
<td> 特征点       </td>
<td> 平移旋转和平移模式下有效，用于计算参考特征和实时特征的平移关系。                                                               </td>
</tr>
<tr>
<td></td>
<td> 特征直线     </td>
<td> 平移旋转和旋转模式下有效，用于计算参考特征和实时特征的旋转关系。                                                               </td>
</tr>
<tr>
<td> 高级界面     </td>
<td> 获取训练图像                                                 </td>
<td> 获取到的训练图像为当前输入图像。                             </td>
</tr>
<tr>
<td></td>
<td> 执行训练     </td>
<td> 执行训练是为了获取参考点（或参考角度），参考点为当前该工具链接的特征点参数（参考角度为当前工具连接的特征直线参数的旋转角度）。                                                               </td>
</tr>
<tr>
<td></td>
<td> 训练参考特征 </td>
<td> 即参考特征，包含参考点和参考角度信息。                                                                                     </td>
</tr>
<tr>
<td></td>
<td> 实时特征     </td>
<td> 即工具执行时链入的特征，包含实时特征点和实时特征角度信息。                                                                 </td>
</tr>
<tr>
<td></td>
<td> 定位结果     </td>
<td> 包含平移量和旋转角度信息。                                                                                                 </td>
</tr>
</tbody>
</table>


<h2>输出</h2>

<table>
<thead>
<tr>
<th>分类 </th>
<th> 参数名称     </th>
<th> 参数描述                                                                                                               </th>
</tr>
</thead>
<tbody>
<tr>
<td> 监视窗口     </td>
<td> 输入轮廓数据                                                 </td>
<td> 输入待检测的轮廓图像的轮廓数据，包括轮廓点数，有效点数。 </td>
</tr>
<tr>
<td></td>
<td> 特征点       </td>
<td> 即实时特征点，为当前工具链入的特征点参数，平移旋转和平移模式下有效。                                                           </td>
</tr>
<tr>
<td></td>
<td> 特征直线     </td>
<td> 即实时特征直线，为当前工具链入的特征直线参数，平移旋转和旋转模式下有效。                                                           </td>
</tr>
<tr>
<td></td>
<td> 参考点       </td>
<td> 即训练参考特征点，为工具训练时链入的特征点参数，平移旋转和平移模式下有效。                                                           </td>
</tr>
<tr>
<td></td>
<td> 参考直线     </td>
<td> 即训练参考特征直线，为工具训练时链入的特征直线参数，平移旋转和旋转模式下有效。                                                           </td>
</tr>
<tr>
<td></td>
<td> 二维线性变换 </td>
<td> 二维线性变换是指目标相对于模板的平移、旋转、缩放变换。                                                                 </td>
</tr>
<tr>
<td></td>
<td> 是否训练     </td>
<td> 表明当前工具是否训练。                                                                                                 </td>
</tr>
<tr>
<td></td>
<td> 执行结果     </td>
<td> 工具执行结果。                                                                                                         </td>
</tr>
<tr>
<td></td>
<td> 执行时间     </td>
<td> 工具执行时间。                                                                                                         </td>
</tr>
<tr>
<td> 图像窗口     </td>
<td> 特征点                                                       </td>
<td> 即实时特征点，同监视窗口的特征点参数。                   </td>
</tr>
<tr>
<td></td>
<td> 特征直线     </td>
<td> 即实时特征直线，同监视窗口的特征直线参数。                                                                             </td>
</tr>
<tr>
<td></td>
<td> 参考点       </td>
<td> 即训练参考特征点，同监视窗口的参考点参数。                                                                             </td>
</tr>
<tr>
<td></td>
<td> 参考直线     </td>
<td> 即训练参考特征直线，同监视窗口的参考直线参数。                                                                         </td>
</tr>
<tr>
<td></td>
<td> 执行结果     </td>
<td> 显示工具执行结果，执行成功显示“OK”，执行失败显示“NG”，同监视窗口的执行结果参数。                                                           </td>
</tr>
<tr>
<td></td>
<td> 数据链       </td>
<td> 同监视窗口参数，供后续工具使用。                                                                                       </td>
</tr>
</tbody>
</table>


<h2>详细说明</h2>

<h3>定位原理</h3>

<p>轮廓定位主要是通过训练轮廓数据固定ROI区域中的特征获取参考特征点和参考旋转角度信息，然后根据实时轮廓数据中相同ROI区域内的对应特征信息，计算得到平移量和旋转角度组成的二维变换定位结果，如图2所示。</p>

<p><img src="media/wps78.png" alt="img" /></p>

<p><imgnote>图1 定位模式示意图</imgnote></p>

<h3>使用向导</h3>

<p><strong>Step 1 获取训练图像</strong></p>

<p>获取到的训练图像为当前输入图像。</p>

<p><strong>Step 2 训练并执行</strong></p>

<p><strong>训练：</strong>训练是为了获取参考点（或参考角度），参考点为当前该工具链接的特征点参数（参考角度为当前工具连接的特征直线参数的旋转角度）。</p>

<p><strong>执行：</strong>通过参考点与特征点之间的关系，计算二维线性变换（当前训练执行后，因此时参考点与特征点相同，故平移结果为0，旋转结果为0）。</p>

<p><strong>Step 3 后续执行</strong></p>

<p>后续执行时，参考点（或参考直线）为训练时获取到的特征点参数（或特征直线参数），特征点为当前实时的输入参数，并通过该二者关系计算当前二维线性变换。</p>

<h2>注意</h2>

<ul>
<li><p>特征点和特征直线参数，可来自轮廓位置测量工具和轮廓线圆拟合工具。在获取实时特征参数时，由于没有二维线性变换，故应选择合适ROI，确保可以检测到实时特征点，进而计算轮廓定位工具的二维线性变换。</p></li>
<li><p>修改定位模式后，工具一定要重新训练（否则会报工具未训练的错误）</p></li>
</ul>


<h2>示例工程</h2>

<p>参见“\Samples\3D\深度图\3D测量工具.gvp”。</p>
