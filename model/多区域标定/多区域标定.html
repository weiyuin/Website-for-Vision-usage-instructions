<head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../css/main.css" /> 
           <script src="../../js/jquery.js"></script> 
           <script src="../../js/main.js"></script> 
           </head> 
           <head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../css/main.css" /> 
           <script src="../../../js/jquery.js"></script> 
           <script src="../../../js/main.js"></script> 
           </head>  
           <head>  
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../../css/main.css" /> 
           <script src="../../../../js/jquery.js"></script> 
           <script src="../../../../js/main.js"></script> 
           </head>
<h1>多区域标定工具</h1>

<h2>功能</h2>

<p>多区域标定工具是在指定的搜索区域内对多组图像坐标和对应的振镜坐标进行关联，适用于将图像划分为多个小区域进行关联的场景，其关联结果如图1所示。</p>

<p><img src="media/wps26.jpg" alt="img" /></p>

<p> <imgnote>(a) 搜索图像</imgnote></p>

<p><img src="media/wps27.jpg" alt="img" /></p>

<p><imgnote>(b) 结果图像</imgnote></p>

<p><imgnote>图1 多区域标定工具应用示意图(整体关联)</imgnote></p>

<h2>参数</h2>

<table>
<thead>
<tr>
<th>分类 </th>
<th> 参数名称     </th>
<th> 参数描述                                                                                                                   </th>
</tr>
</thead>
<tbody>
<tr>
<td> 属性窗口     </td>
<td> 是否融合像素当量                                             </td>
<td> 选择“是”，需要对数据链中输入像素当量参数进行配置，是将像素当量值与图像振镜夹角进行融合得到转换矩阵。 </td>
</tr>
<tr>
<td></td>
<td>标定精度</td>
<td>完成标定后使用标定结果反向计算出9个圆心的理论激光坐标，并和实际坐标比较得到每个圆心处的标定误差，当圆心标定误差超过此值时，将其误差文本置为红色，以提示用户此标定结果误差过大，仅做提示用，不影响工具的执行成功与否。</td>
</tr>
<tr>
<td> 图像窗口     </td>
<td> 输入图像                                                     </td>
<td> 显示与振镜坐标相关联的图像。                                 </td>
</tr>
<tr>
<td> 数据链       </td>
<td> 输入图像                                                     </td>
<td> 输入图像宽度、高度、像素大小，同图像窗口的输入图像参数。     </td>
</tr>
<tr>
<td></td>
<td> X轴方向      </td>
<td> 振镜X坐标轴方向。                                                                                                          </td>
</tr>
<tr>
<td></td>
<td> Y轴方向      </td>
<td> 振镜Y坐标轴方向。                                                                                                          </td>
</tr>
<tr>
<td> 高级界面     </td>
<td> 关联模式                                                     </td>
<td> 图像坐标与振镜坐标关联的方式，分为2种，单个关联和整体关联。<img src="media/wps29.jpg" alt="img" /> </td>
</tr>
<tr>
<td></td>
<td> 振镜坐标     </td>
<td> 输入相关联的振镜坐标，由TXT文件导入，其中TXT文件每行有9个坐标数据，坐标数据间用分号隔开，坐标数据的X、Y数据用逗号隔开。例如 3.5,4.6；                                                               </td>
</tr>
<tr>
<td></td>
<td> 圆提取方式   </td>
<td> 提取方式分为2种，手动提取或自动提取。<img src="media/wps30.jpg" alt="img" />                                                               </td>
</tr>
<tr>
<td></td>
<td> 圆特征       </td>
<td> 根据Mark点颜色分为白色和黑色。                                                                                             </td>
</tr>
</tbody>
</table>


<h2>输出</h2>

<table>
<thead>
<tr>
<th>分类 </th>
<th> 参数名称     </th>
<th> 参数描述                                                                                                                   </th>
</tr>
</thead>
<tbody>
<tr>
<td> 监视窗口     </td>
<td> 输入图像                                                     </td>
<td> 输出图像宽度、高度、像素大小。                               </td>
</tr>
<tr>
<td></td>
<td> 二维线性变换 </td>
<td> 输出图像坐标与振镜坐标关联后的矩阵信息。                                                                                   </td>
</tr>
<tr>
<td></td>
<td> 图像坐标     </td>
<td> 输出图像坐标与振镜坐标关联后图像坐标点集。                                                                                 </td>
</tr>
<tr>
<td></td>
<td> 激光坐标   </td>
<td> 输出的激光坐标点集。                                                                                                     </td>
</tr>
<tr>
<td></td>
<td> 标定信息   </td>
<td> 标定信息字符串。                                                                      </td>
</tr>
<tr>
<td></td>
<td> 执行结果     </td>
<td> 工具执行结果。                                                                                                             </td>
</tr>
<tr>
<td></td>
<td> 执行时间     </td>
<td> 工具执行时间。                                                                                                             </td>
</tr>
<tr>
<td> 图像窗口     </td>
<td> 输入图像                                                     </td>
<td> 显示与振镜坐标相关联的图像，同监视窗口的输出图像参数。       </td>
</tr>
<tr>
<td></td>
<td> 执行结果     </td>
<td> 显示工具执行结果，执行成功显示“OK”，执行失败显示“NG”，同监视窗口的执行结果参数。                                                               </td>
</tr>
<tr>
<td> 数据链       </td>
<td> 二维线性变换                                                 </td>
<td> 输出图像坐标与振镜坐标关联后的矩阵信息，供后序多区域振镜位置计算工具使用，同监视窗口的二维线性变换参数。 </td>
</tr>
<tr>
<td></td>
<td> 图像坐标     </td>
<td> 输出图像坐标与振镜坐标关联后图像坐标点集，供后序多区域振镜位置计算工具使用，同监视窗口的图像坐标参数。                                                               </td>
</tr>
<tr>
<td></td>
<td> 激光坐标   </td>
<td> 输出的激光坐标点集，供后序多区域振镜位置计算工具使用，同监视窗口的激光坐标参数。                                                             </td>
</tr>
</tbody>
</table>


<h2>详细说明</h2>

<h3>关联模式</h3>

<p>1.单个关联模式</p>

<ul>
<li><p>单个关联每次只关联一组图像坐标和振镜坐标(9个)，在如图所示2的下拉列表中选择当前关联的数据组，关联成功时，状态栏显示第x组关联成功，然后改变关联数据组，拖动搜索区域，进行下一组数据坐标的关联，直至完成所有的图像坐标与振镜坐标关联。</p></li>
<li><p>单组关联失败时，可以改变下拉列表中当前选择数据组的提取方式或者改变搜索区域，直到关联成功，再进行下一组标定。</p></li>
<li><p>关联完成后点击标定确认按钮，根据状态栏显示提示信息，如果哪一组未关联成功，对该组数据重新进行关联。</p></li>
</ul>


<p>2.整体关联模式</p>

<ul>
<li><p>整体关联一次可以完成所有图像坐标和振镜坐标的关联，关联时搜索区域需要按顺序摆放如图3所示，关联完成后，点击标定确认按钮。</p></li>
<li><p>整体关联完成后，可以对其中的单组数据再次进行关联，在下拉列表中，选择要重新关联的数据组，选择合适的提取方式，点击单组标定。</p></li>
</ul>


<p><img src="media/wps33.jpg" alt="img" /></p>

<p><imgnote>图2 多区域标定工具高级属性界面</imgnote></p>

<h3>提取方式</h3>

<p>手动提取是指在搜索区域内手动摆放卡尺提取Mark点，其中每个搜索区域内卡尺的排放顺序如图3所示。自动提取只在搜索区域内自动提取Mark点。</p>

<p><img src="media/wps34.jpg" alt="img" /></p>

<p><imgnote>图3 手动模式卡尺摆放顺序示意图</imgnote></p>

<h2>注意</h2>

<ul>
<li><p>多区域标定工具与多区域振镜位置计算工具配合使用。</p></li>
<li><p>多区域标定工具必须在高级属性界面完成关联后，才能在流程图中正常使用。</p></li>
<li><p>多区域标定工具在高级属性界面完成关联退出后，如果想重新关联其中的某一组时，重新进入高级属性界面，选择单组关联模式，在下拉列表中选择要重新标定的数据组，拖动搜索区域到对应的图像位置处，点击单组关联即可。切记不要重新导入数据，如果误操作点击Load按钮，点取消退出即可；或者误操作重新导入数据，那么重新进入高级属性界面即可。</p></li>
<li><p>多区域标定工具在手动提取模式下，鼠标左键双击其中一个找圆卡尺，在弹出的属性对话框中改变其参数(卡尺数量、卡尺搜索方向)，然后鼠标拖动该找圆卡尺(改变搜索长度和投影长度参数)，即可完成所有找圆卡尺的同步刷新。</p></li>
</ul>


<h2>示例工程</h2>

<p>参见“\Samples\多区域标定工具.gvp”。</p>
