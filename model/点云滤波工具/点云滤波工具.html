<head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../css/main.css" /> 
           <script src="../../js/jquery.js"></script> 
           <script src="../../js/main.js"></script> 
           </head> 
           <head> 
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../css/main.css" /> 
           <script src="../../../js/jquery.js"></script> 
           <script src="../../../js/main.js"></script> 
           </head>  
           <head>  
           <meta charset="utf-8"> 
           <link rel="stylesheet" href="../../../../css/main.css" /> 
           <script src="../../../../js/jquery.js"></script> 
           <script src="../../../../js/main.js"></script> 
           </head>
<h1>点云滤波工具</h1>

<h2>1.功能概述</h2>

<p>​         点云滤波工具主要服务于3D点云测量项目，解决点云降噪、平滑等问题，工具主要应用在三维测量项目的预处理阶段。</p>

<h2>2.使用场景</h2>

<p>​         典型的应用场景如：获取点云数据时，由于<em>设备精度、操作者经验、环境因素、以及电磁波的衍射特性</em>（<strong>电磁波遇到障碍物时偏离原来直线传播的物理现象</strong>）等带来的影响，点云数据中将不可避免地出现一些噪点；此外，实际应用时除了这些随机误差产生的噪点外，由于受到外界干扰如<em>视线遮挡、障碍物</em>等因素，点云数据中还会存在一些离主体点较远的 离群点。点云滤波工具可以有效地过滤噪点和离群点。</p>

<div align="center">
<img src="media/GvCloudFilterTool_2_1.PNG" style="zoom:100%;"/>
    <center>图2_1 点云降噪
</center>
</div>


<h2>3.使用向导</h2>

<ul>
<li><h3>3.1 统计学滤波</h3>

<p><strong>step1:</strong>   添加点云文件、点云滤波工具，并双击打开参数链，链接点云文件，如图3-1所示；</p>

<p><strong>step2：</strong>右击点云滤波工具“属性”打开工具高级界面，如图3-2所示，滤波类型选择“统计学滤波”，滤波模式选择“统计学”；设置滤波参数，然后点击运行即可得到统计学滤波之后的点云数据；</p></li>
</ul>


<div align="center">
<img src="media/GvCloudFilterTool_3_1.PNG" style="zoom:70%;"/>
    <center>图3_1 点云滤波：滤波流程</center>
</div>




<div align="center">
<img src="media/GvCloudFilterTool_3_2.gif" style="zoom:70%;"/>
    <center>图3_2 点云滤波：统计学滤波</center>
</div>


<ul>
<li><h3>3.2 体素滤波</h3>

<p><strong>step1:</strong>   添加点云文件、点云滤波工具，并双击打开参数链，链接点云文件，如图3-1所示；</p>

<p><strong>step2：</strong>右击点云滤波工具“属性”打开工具高级界面，如图3-3所示，滤波类型选择“统计学滤波”，滤波模式选择“体素”；设置滤波参数，然后点击运行即可得到体素滤波之后的点云数据；</p>

<div align="center">
<img src="media/GvCloudFilterTool_3_3.gif" style="zoom:70%;"/>
    <center>图3_3 点云滤波：体素滤波</center>
</div>
</li>
<li><h3>3.3 平滑滤波</h3>

<p><strong>step1:</strong>   添加点云文件、点云滤波工具，并双击打开参数链，链接点云文件，如图3-1所示；</p>

<p><strong>step2：</strong>右击点云滤波工具“属性”打开工具高级界面，如图3-4所示，滤波类型选择“平滑滤波”；设置滤波参数，然后点击运行即可得到平滑滤波之后的点云数据；</p>

<div align="center">
<img src="media/GvCloudFilterTool_3_4.gif" style="zoom:70%;"/>
    <center>图3_4 点云滤波：平滑滤波</center>
</div>
</li>
</ul>


<h2>4.常见问题</h2>

<h2>5.参数说明</h2>

<h4>输入参数（参数链）</h4>

<table>
<thead>
<tr>
<th> 参数名称 </th>
<th> 参数描述  </th>
</tr>
</thead>
<tbody>
<tr>
<td> 输入点云数据 </td>
<td> 链接外部的的点云图像 </td>
</tr>
</tbody>
</table>


<h4>输入参数（属性窗口）</h4>

<table>
<thead>
<tr>
<th> 参数名称 </th>
<th> 参数描述  </th>
</tr>
</thead>
<tbody>
<tr>
<td> 点云滤波类型    </td>
<td> 包括：统计学滤波和平滑滤波                                  </td>
</tr>
<tr>
<td> 是否启用ROI </td>
<td> 选择“是”，则使用长方体框选ROI进行拟合；选择“否”，则对全点云进行平面拟合 </td>
</tr>
<tr>
<td> ROI个数 </td>
<td> 启用ROI的情况下，用于设置ROI的个数，范围：[1,50] </td>
</tr>
<tr>
<td> ROI索引 </td>
<td> 用于不同索引下切换 </td>
</tr>
<tr>
<td> 长方体ROI </td>
<td> 当前索引下的ROI </td>
</tr>
<tr>
<td> 滤波模式        </td>
<td> 包括：统计学和体素                                          </td>
</tr>
<tr>
<td> 邻域点数 </td>
<td> 指定KNN近邻搜索的邻域点数，即指定邻域搜索范围；取值范围为(0,125] </td>
</tr>
<tr>
<td> 标准差系数      </td>
<td> 用于领域点平均距离阈值的自动确定；取值范围为[0.01,5]        </td>
</tr>
<tr>
<td> 反向滤波 </td>
<td> 结果取反 </td>
</tr>
<tr>
<td> 体素尺寸X、Y、Z </td>
<td> 指定单个体素网格尺寸大小，以此对整片点云进行体素划分；取值范围为[0.001,1] </td>
</tr>
<tr>
<td> 自动设置 </td>
<td> 自动设置邻域点数阈值 </td>
</tr>
<tr>
<td> 邻域点数阈值   </td>
<td> 指定或自动确定邻域点数阈值，小于阈值的则为噪声点；取值范围为(0,500] </td>
</tr>
<tr>
<td> 搜索方法        </td>
<td> 指定近邻搜索方法为KNN近邻搜索、相对半径搜索或绝对半径搜索   </td>
</tr>
<tr>
<td> 相对/绝对搜索半径 </td>
<td> 指定半径搜索的相对范围，相对半径搜索半径为输入值乘以点云分辨率；相对取值范围为[0.1, 10]，绝对取值范围[0.001,1] </td>
</tr>
<tr>
<td> 邻域搜索点数    </td>
<td> 指定KNN近邻搜索的邻域搜索点数；取值范围为[3,150]            </td>
</tr>
<tr>
<td> 高级参数设置 </td>
<td> 是：显示高级参数，否：不显示高级参数 </td>
</tr>
<tr>
<td> 投影方式        </td>
<td> 指定各点的投影方式，包含不投影、简单投影和垂直投影          </td>
</tr>
<tr>
<td> Sigma计算方式   </td>
<td> 包含默认Sigma、绝对Sigma和相对sigma；默认sigma为根据不同搜索方法自动确定相应的sigma值；绝对sigma为输入值；相对sigma为输入值乘以邻域点距的中值。Sigma越大，拟合的曲面越平滑；取值范围为[0.001,1000] </td>
</tr>
<tr>
<td> Sigma值 </td>
<td> 取值范围为[0.001, 1000] </td>
</tr>
<tr>
<td> 多项式阶次      </td>
<td> 指定表征MLS曲面的多项式阶次，阶次越大，在拟合曲面上的邻域点越多，高阶次容易过拟合且效率慢，推荐参数为二阶，取值范围为[1, 4] </td>
</tr>
<tr>
<td> 上采样方法      </td>
<td> 指定结果点云的上采样方法，包含不采样、局部平面、均匀分布和体素扩增 </td>
</tr>
<tr>
<td> 采样半径设置    </td>
<td> 包含绝对采样半径和相对采样半径                              </td>
</tr>
<tr>
<td> 上采样相对/绝对半径 </td>
<td> 针对局部平面上采样方法设置，指定上采样的局部平面大小。若设置为相对值，则上采样半径为输入值乘以点云分辨率 </td>
</tr>
<tr>
<td> 上采样相对/绝对步长 </td>
<td> 针对局部平面上采样方法设置，指定上采样的步长。若设置为相对值，则上采样步长为输入值乘以点云分辨率 </td>
</tr>
<tr>
<td> 期望点数 </td>
<td> 针对均匀分布上采样方法设置，指定在一定半径搜索范围内上采样后达到的点数；取值范围为[1, 500] </td>
</tr>
<tr>
<td> MLS体素-X、Y、Z </td>
<td> 针对体素扩增上采样方法设置，指定点云体素划分的体素尺寸大小；取值范围为[0.001, 1] </td>
</tr>
<tr>
<td> 体素扩增次数 </td>
<td> 针对体素扩增上采样方法设置，指定体素扩增上采样的次数；取值范围为[0, 10] </td>
</tr>
<tr>
<td> 开启并行运算 </td>
<td> 是否开启并行运算，选择是时，算法将开启OpenMp并行计算方式，可以提升计算速度，但可能出现耗时不稳定的情况，选择否时，算法将关闭OpenMp并行计算。 </td>
</tr>
<tr>
<td> 线程数百分比 </td>
<td> 设置并行运算的线程数百分比，有效范围为 (0, 0.75]，对应表示(0%, 75%]百分比范围。 </td>
</tr>
</tbody>
</table>


<h4>输入参数（高级界面）</h4>

<p>高级界面参数与属性窗口参数一致，交互按钮如下：</p>

<table>
<thead>
<tr>
<th> 按钮名称           </th>
<th> 参数描述                                                                                                                  </th>
</tr>
</thead>
<tbody>
<tr>
<td> 添加ROI </td>
<td> 在高级界面图像中，自动添加长方体ROI </td>
</tr>
<tr>
<td> 绘制当前ROI </td>
<td> 在高级界面图像中，相应位置点击并拖动鼠标即可绘制当前索引下的长方体ROI </td>
</tr>
<tr>
<td> 删除当前ROI                            </td>
<td> 在高级界面图像中，相应位置点击并拖动鼠标即可删除当前索引下的长方体ROI </td>
</tr>
</tbody>
</table>


<h4>输出参数（参数链）</h4>

<table>
<thead>
<tr>
<th> 参数名称     </th>
<th> 参数描述             </th>
</tr>
</thead>
<tbody>
<tr>
<td> 输出点云数据 </td>
<td> 显示滤波后的点云图像 </td>
</tr>
</tbody>
</table>


<h4>输出参数（输出窗口）</h4>

<table>
<thead>
<tr>
<th> 参数名称     </th>
<th> 参数描述             </th>
</tr>
</thead>
<tbody>
<tr>
<td> 输出点云数据 </td>
<td> 显示滤波后的点云图像 </td>
</tr>
<tr>
<td> 执行结果     </td>
<td> 工具执行结果         </td>
</tr>
<tr>
<td> 执行时间     </td>
<td> 工具执行时间         </td>
</tr>
</tbody>
</table>


<h2>6.示例工程</h2>

<p>参见“\Samples\3D\点云\点云测量.gvp”。</p>

<h2>7.特殊说明</h2>

<h3>滤波原理</h3>

<p><strong>点云滤波工具：</strong>主要包括统计学滤波、体素滤波和平滑滤波功能；</p>

<p><strong>统计学原理：</strong>采用基于统计学的思想，将点云平均点距看作服从正态分布的形式对输入点云进行滤波降噪；</p>

<p><strong>体素噪声滤波原理：</strong>通过对噪声点云进行体素网格划分，根据指定的邻域点数或由指定大小的体素邻域自动确定的邻域点数筛选出符合预期的结果点；</p>

<p><strong>MLS移动最小二乘平滑原理：</strong>对输入点云进行局部邻域曲面拟合，根据曲面修正点位置与法线；</p>

<p><strong>投影方法：</strong>指定各点的投影方式，包含<strong>不投影、简单投影和垂直投影</strong>。不投影，各点修正平滑为邻域局部拟合平面的投影点；简单投影，各点修正平滑为沿法线方向在拟合曲面的投影点；垂直投影，各点修正平滑为沿垂直拟合曲面方向上的曲面投影点。垂直投影的平滑效果优于简单投影，简单投影效率优于垂直投影，如图7-1所示。</p>

<div align="center">
<img src="media/GvCloudFilterTool_7_1.png" style="zoom:70%;"/>
    <center>图7_1 点云滤波：简单投影、垂直投影</center>
</div>


<p><strong>上采样方法：</strong>指定结果点云的上采样方法，包含<strong>不采样、局部平面、均匀分布和体素扩增</strong>。</p>

<ul>
<li><p>不采样，平滑结果点云不进行上采样；</p></li>
<li><p>局部平面，平滑结果点云各点在指定大小且以法线为平面法向的局部平面内进行指定步长取点上采样，如图7-2所示；</p></li>
<li><p>均匀随机分布，平滑结果点云在一定半径搜索范围内进行随机取点上采样；</p></li>
<li><p>体素扩增，对平滑结果点云进行体素划分，并对各点26邻域网格作有效化处理，根据体素尺寸对扩增的体素网格进行取点上采样，如图7-3所示。</p></li>
</ul>


<div align="center">
<img src="media/GvCloudFilterTool_7_2.png" style="zoom:100%;"/>
    <center>图7_2 点云滤波：简单局部平面投影</center>
</div>




<div align="center">
<img src="media/GvCloudFilterTool_7_3.png" style="zoom:100%;"/>
    <center>图7_3 点云滤波：体素网格扩增上采样</center>
</div>



